<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Match - Pony Tutorial</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Pony Tutorial">
    <meta property="og:image" content="None/../../">
    <meta name="apple-mobile-web-app-title" content="Pony Tutorial">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-20d5debb47.css">
    
    
      
      
      
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../css/highlight.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Pattern Matching <i class="icon icon-link"></i>
              
            
          </span>
        
        Match
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="/" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>Pony Tutorial </strong>
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
      <div class="toc">
        <ul>
          
            
  <li>
    <span class="section">Getting started</span>
    <ul>
      
        
  <li>
    <a class="" title="Welcome!" href="../..">
      Welcome!
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="What you need to start" href="../../getting-started/what-you-need-to-start/">
      What you need to start
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Installation" href="../../getting-started/installation/">
      Installation
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Helloworld" href="../../getting-started/helloworld/">
      Helloworld
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="How it works" href="../../getting-started/how-it-works/">
      How it works
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Whitespace" href="../../getting-started/whitespace/">
      Whitespace
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Types</span>
    <ul>
      
        
  <li>
    <a class="" title="Static vs dynamic" href="../../types/static-vs-dynamic/">
      Static vs dynamic
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Classes" href="../../types/classes/">
      Classes
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Primitives" href="../../types/primitives/">
      Primitives
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Actors" href="../../types/actors/">
      Actors
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Traits and interfaces" href="../../types/traits-and-interfaces/">
      Traits and interfaces
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Type aliases" href="../../types/type-aliases/">
      Type aliases
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Type expressions" href="../../types/type-expressions/">
      Type expressions
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Delegates" href="../../types/delegates/">
      Delegates
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Expressions</span>
    <ul>
      
        
  <li>
    <a class="" title="Variables" href="../../expressions/variables/">
      Variables
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Infix ops" href="../../expressions/infix-ops/">
      Infix ops
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Control structures" href="../../expressions/control-structures/">
      Control structures
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Methods" href="../../expressions/methods/">
      Methods
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Exceptions" href="../../expressions/exceptions/">
      Exceptions
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Sugar" href="../../expressions/sugar/">
      Sugar
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Object literals" href="../../expressions/object-literals/">
      Object literals
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Partial application" href="../../expressions/partial-application/">
      Partial application
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Capabilities</span>
    <ul>
      
        
  <li>
    <a class="" title="Object capabilities" href="../../capabilities/object-capabilities/">
      Object capabilities
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Reference capabilities" href="../../capabilities/reference-capabilities/">
      Reference capabilities
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Guarantees" href="../../capabilities/guarantees/">
      Guarantees
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Aliasing" href="../../capabilities/aliasing/">
      Aliasing
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Consume and destructive read" href="../../capabilities/consume-and-destructive-read/">
      Consume and destructive read
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Recovering capabilities" href="../../capabilities/recovering-capabilities/">
      Recovering capabilities
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Combining capabilities" href="../../capabilities/combining-capabilities/">
      Combining capabilities
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Passing and sharing" href="../../capabilities/passing-and-sharing/">
      Passing and sharing
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Capability subtyping" href="../../capabilities/capability-subtyping/">
      Capability subtyping
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Arrow types" href="../../capabilities/arrow-types/">
      Arrow types
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Trust boundary" href="../../capabilities/trust-boundary/">
      Trust boundary
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Generics</span>
    <ul>
      
        
  <li>
    <a class="" title="Polymorphic types" href="../../generics/polymorphic-types/">
      Polymorphic types
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Polymorphic methods" href="../../generics/polymorphic-methods/">
      Polymorphic methods
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Code sharing" href="../../composition-inheritance/code-sharing/">
      Code sharing
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Pattern Matching</span>
    <ul>
      
        
  <li>
    <a class="current" title="Match" href="./">
      Match
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Else cases" href="#else-cases">
                Else cases
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
        
  <li>
    <a class="" title="As" href="../as/">
      As
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Packages</span>
    <ul>
      
        
  <li>
    <a class="" title="Package system" href="../../packages/package-system/">
      Package system
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Use statement" href="../../packages/use-statement/">
      Use statement
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Builtin" href="../../packages/builtin/">
      Builtin
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Use conditions" href="../../packages/platform/">
      Use conditions
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Compiler args" href="../../compiler-clargs/clargs/">
      Compiler args
    </a>
    
  </li>

          
            
  <li>
    <span class="section">C FFI</span>
    <ul>
      
        
  <li>
    <a class="" title="Calling C" href="../../c-ffi/calling-c/">
      Calling C
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Linking to C Libraries" href="../../c-ffi/linking-c/">
      Linking to C Libraries
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="C abi" href="../../c-ffi/c-abi/">
      C abi
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">The Runtime</span>
    <ul>
      
        
  <li>
    <a class="" title="Otp" href="../../runtime/otp/">
      Otp
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Memory allocation" href="../../runtime/memory-allocation/">
      Memory allocation
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Garbage collection" href="../../runtime/garbage-collection/">
      Garbage collection
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Examples" href="../../examples/examples/">
      Examples
    </a>
    
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <p>If we want to compare an expression to a value then we use an <code>if</code>. But if we want to compare an expression to a lot of values this gets very tedious. Pony provides a powerful pattern matching facility, combining matching on values and types, without any special code required.</p>
<h1 id="match-expressions">Match expressions</h1>
<p>Here's a simple example of a match expression that produces a string.</p>
<pre><code class="pony">match x
| 2 =&gt; &quot;int&quot;
| 2.0 =&gt; &quot;float&quot;
| &quot;2&quot; =&gt; &quot;string&quot;
else
  &quot;something else&quot;
end
</code></pre>

<p>If you're used to functional languages this should be very familiar.</p>
<p>For those readers more familiar with the C and Java family of languages, think of this like a switch statement. But you can switch on values other than just integers, like Strings. In fact you can switch on any type that provides a comparison function, including your own classes. And you can also switch on the runtime type of an expression.</p>
<p>A match starts with the keyword <code>match</code>, followed by the expression to match, which is known as the match <strong>operand</strong>. In this example the operand is just the variable <code>x</code>, but it can be any expression.</p>
<p>Most of the match expression consists of a series of <strong>cases</strong> that we match against. Each case consists of a pipe symbol ('|'), the <strong>pattern</strong> to match against, an arrow ('=&gt;') and the expression to evaluate if the case matches.</p>
<p>We go through the cases one by one until we find one that matches. (Actually, in practice the compiler is a lot more intelligent than that and uses a combination of sequential checks and jump tables to be as efficient as possible.)</p>
<p>Note that each match case has an expression to evaluate and these are all independent. There is no "fall through" between cases as there is in languages such as C.</p>
<p>If the value produced by the match expression isn't used then the cases can omit the arrow and expression to evaluate. This can be useful for excluding specific cases before a more general case.</p>
<h2 id="else-cases">Else cases</h2>
<p>As with all Pony control structures the else case for a match expression is used if we have no other value, i.e. if none of our cases match. The else case, if there is one, <strong>must</strong> come at the end of the match, after all of the specific cases.</p>
<p>If the value the match expression results in is used then you need to have an else case, even if it can never actually be reached. If you omit it a default will be added which evaluates to <code>None</code>. The compiler currently isn't clever enough to spot when the other cases are exhaustive and so the else is not needed. This will be changed later.</p>
<h1 id="matching-on-values">Matching on values</h1>
<p>The simplest match expression just matches on value.</p>
<pre><code class="pony">fun f(x: U32): String =&gt;
  match x
  | 1 =&gt; &quot;one&quot;
  | 2 =&gt; &quot;two&quot;
  | 3 =&gt; &quot;three&quot;
  | 5 =&gt; &quot;not four&quot;
  else
    &quot;something else&quot;
  end
</code></pre>

<p>For value matching the pattern is simply the value we want to match to, just like a C switch statement. The case with the same value as the operand wins and we use its expression.</p>
<p>The compiler calls the eq() function on the operand, passing the pattern as the argument. This means that you can use your own types as match operands and patterns, as long as you define an eq() function.</p>
<pre><code class="pony">class Foo
  var _x: U32

  new create(x: U32) =&gt;
    _x = x

  fun eq(that: Foo): Bool =&gt;
    _x == that._x

actor Main
  fun f(x: Foo): String =&gt;
    match x
    | Foo(1) =&gt; &quot;one&quot;
    | Foo(2) =&gt; &quot;two&quot;
    | Foo(3) =&gt; &quot;three&quot;
    | Foo(5) =&gt; &quot;not four&quot;
    else
      &quot;something else&quot;
    end
</code></pre>

<h1 id="matching-on-type-and-value">Matching on type and value</h1>
<p>Matching on value is fine if the match operand and case patterns have all the same type. However match can cope with multiple different types. Each case pattern is first checked to see if it is the same type as the runtime type of the operand. Only then will the values be compared.</p>
<pre><code class="pony">fun f(x: (U32 | String | None)): String =&gt;
  match x
  | None =&gt; &quot;none&quot;
  | 2 =&gt; &quot;two&quot;
  | 3 =&gt; &quot;three&quot;
  | &quot;5&quot; =&gt; &quot;not four&quot;
  else
    &quot;something else&quot;
  end
</code></pre>

<p>In many languages using runtime type information is very expensive and so it is generally avoided whenever possible.</p>
<p>In Pony it's cheap. Really cheap. Pony's "whole program" approach to compilation means the compiler can work out as much as possible at compile time. The runtime cost of each type check is generally a single pointer comparison. Plus of course, any checks which can be fully determined at compile time are. So for up casts there's no runtime cost at all.</p>
<h2 id="captures">Captures</h2>
<p>Sometimes you want to be able to match on type, for any value of that type. For this you use a <strong>capture</strong>. This defines a local variable, valid only within the case, containing the value of the operand. If the operand is not of the specified type then the case doesn't match.</p>
<p>Captures look just like variable declarations within the pattern. Like normal variables they can be declared as var or let. If you're not going to reassign them within the case expression it is good practice to use let.</p>
<pre><code class="pony">fun f(x: (U32 | String | None)): String =&gt;
  match x
  | None =&gt; &quot;none&quot;
  | 2 =&gt; &quot;two&quot;
  | 3 =&gt; &quot;three&quot;
  | let u: U32 =&gt; &quot;other integer&quot;
  | let s: String =&gt; s
  else
    &quot;something else&quot;
  end
</code></pre>

<p><strong>Can I omit the type from a capture, like I can from a local variable?</strong> Unfortunately no. Since we match on type and value the compiler has to know what type the pattern is, so it can't be inferred.</p>
<h1 id="matching-tuples">Matching tuples</h1>
<p>If you want to match on more than one operand at once then you can simply use a tuple. Cases will only match if <strong>all</strong> the tuple elements match.</p>
<pre><code class="pony">fun f(x: (String | None), y: U32): String =&gt;
  match (x, y)
  | (None, let y: U32) =&gt; &quot;none&quot;
  | (let s: String, 2) =&gt; s + &quot; two&quot;
  | (let s: String, 3) =&gt; s + &quot; three&quot;
  | (let s: String, let u: U32) =&gt; s + &quot; other integer&quot;
  else
    &quot;something else&quot;
  end
</code></pre>

<p><strong>Do I have to specify all the elements in a tuple?</strong> No you don't. Any tuple elements in a pattern can be marked as "don't care" by using an underscore ('_'). The first and fourth cases in our example don't actually care about the U32 element, so we can ignore it.</p>
<pre><code class="pony">fun f(x: (String | None), y: U32): String =&gt;
  match (x, y)
  | (None, _) =&gt; &quot;none&quot;
  | (let s: String, 2) =&gt; s + &quot; two&quot;
  | (let s: String, 3) =&gt; s + &quot; three&quot;
  | (let s: String, _) =&gt; s + &quot; other integer&quot;
  else
    &quot;something else&quot;
  end
</code></pre>

<h1 id="guards">Guards</h1>
<p>In addition to matching on types and values each case in a match can also have a guard condition. This is simply an expression, evaluated <strong>after</strong> type and value matching has occurred, that must give the value true for the case to match. If the guard is false then the case doesn't match and we move onto the next in the usual way.</p>
<p>Guards are introduced with the <code>if</code> keyword (<em>was <code>where</code> until 0.2.1</em>).</p>
<p>A guard expression may use any captured variables from that case, which allows for handling ranges and complex functions.</p>
<pre><code class="pony">fun f(x: (String | None), y: U32): String =&gt;
  match (x, y)
  | (None, _) =&gt; &quot;none&quot;
  | (let s: String, 2) =&gt; s + &quot; two&quot;
  | (let s: String, 3) =&gt; s + &quot; three&quot;
  | (let s: String, let u: U32) if u &gt; 14 =&gt; s + &quot; other big integer&quot;
  | (let s: String, _) =&gt; s + &quot; other small integer&quot;
  else
    &quot;something else&quot;
  end
</code></pre>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../../composition-inheritance/code-sharing/" title="Code sharing">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Code sharing
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../as/" title="As">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                As
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = '';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="../../js/highlight.pack.js"></script>
    
    
  </body>
</html>